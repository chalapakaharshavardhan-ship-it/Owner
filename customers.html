<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>TaskPro - Customers</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"/>
    <link rel="stylesheet" href="customers.css">
    <link rel="stylesheet" href="view-orders.css">
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="nav-profile.css">
  </head>
  <body>
    <!-- NAVBAR -->
    <header class="navbar">
      <div class="nav-inner">
        <div class="brand">
          <div class="logo">
            <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" fill="white" class="bi bi-check2-square" viewBox="0 0 16 16">
              <path d="M3 14.5A1.5 1.5 0 0 1 1.5 13V3A1.5 1.5 0 0 1 3 1.5h8a.5.5 0 0 1 0 1H3a.5.5 0 0 0-.5.5v10a.5.5 0 0 0 .5.5h10a.5.5 0 0 0 .5-.5V8a.5.5 0 0 1 1 0v5a1.5 1.5 0 0 1-1.5 1.5z"/>
              <path d="m8.354 10.354 7-7a.5.5 0 0 0-.708-.708L8 9.293 5.354 6.646a.5.5 0 1 0-.708.708l3 3a.5.5 0 0 0 .708 0"/>
            </svg>
          </div>
          <span class="brand-name">TaskPro</span>
        </div>
        <div class="nav-actions">
          <a href="dashboard.html" class="dashboard-pill">
            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="white" class="bi bi-house" viewBox="0 0 16 16">
              <path d="M8.707 1.5a1 1 0 0 0-1.414 0L.646 8.146a.5.5 0 0 0 .708.708L2 8.207V13.5A1.5 1.5 0 0 0 3.5 15h9a1.5 1.5 0 0 0 1.5-1.5V8.207l.646.647a.5.5 0 0 0 .708-.708L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293zM13 7.207V13.5a.5.5 0 0 1-.5.5h-9a.5.5 0 0 1-.5-.5V7.207l5-5z"/>
            </svg>
            <span class="dashboard-text">Dashboard</span>
          </a>
          <div class="profile" id="profile">
            <div id="profileIcon" class="profile-trigger">
              <img
                src="download.jpeg"
                alt="Profile"
                style="width: 34px; height: 34px; border-radius: 50%"
              />
            </div>
            <div id="profileDropdown" class="profile-dropdown">
              <ul>
                <p class="para">Owner</p>
                <p class="para">Owner@gmail.com</p>
                <hr>
                <li><a href="#" id="editprofileLink">Edit</a></li>
                <li><a href="#" id="settingsLink">Settings</a></li>
                <hr>
                <li><a href="#" id="logoutLink">Logout</a></li>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </header>
    <!-- MAIN CONTENT -->
    <main class="container">
      <section class="hero">
        <center>
        <h1 class="page-title">Customer Management</h1>
        <p class="subtitle">View and manage all customer accounts</p>
        </center>
      </section>

      <section class="search-container">
        <div style="display: flex; align-items: center; gap: 10px;">
          <input type="text" id="searchInput" class="search-box" placeholder="Search customers..." oninput="searchCustomers()" />
          <button class="search-btn">Search</button>
        </div>
        <div class="total-customers" id="totalCustomers">Total Customers: 0</div>
      </section>

      <div class="table-container">
        <table id="customersTable">
          <thead>
            <tr>
              <th>Username</th>
              <th>Email</th>
              <th>Name</th>
              <th>Joined</th>
              <th>Orders</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody id="tableBody"></tbody>
        </table>
      </div>

      <div class="pagination">
        <button id="prevBtn">Previous</button>
        <span id="pageNumbers"></span>
        <button id="nextBtn">Next</button>
      </div>
    </main>

    <footer class="footer">
      <small>©️ <span id="year"></span> TaskPro — Customers Management</small>
    </footer>

    <script>
      document.getElementById("year").textContent = new Date().getFullYear();

      const tableBody = document.getElementById("tableBody");
      const prevBtn = document.getElementById("prevBtn");
      const nextBtn = document.getElementById("nextBtn");
      const pageNumbers = document.getElementById("pageNumbers");
      let currentPage = 1;

      const customers = [
        { username: 'kalyan', email: 'babukalyan523@gmail.com', name: 'Not provided', joined: 'Aug 30, 2025', orders: 0 },
        { username: 'customerr', email: 'customer1230@gmail.com', name: 'cust tomer', joined: 'Sep 06, 2025', orders: 0 },
        { username: 'customer.', email: 'customer123@gmail.com', name: 'cus tomer', joined: 'Sep 06, 2025', orders: 0 },
        { username: 'customer', email: 'customer@gmail.com', name: 'customer c', joined: 'Sep 06, 2025', orders: 0 },
        { username: 'Ravirekula', email: 'Not provided', name: 'Not provided', joined: 'Sep 06, 2025', orders: 0 },
        { username: 'rkk', email: 'Not provided', name: 'Not provided', joined: 'Sep 02, 2025', orders: 0 }
      ];

      let filteredCustomers = [...customers];

      function updateTable(page) {
        tableBody.innerHTML = "";
        let customersToShow = page === 1 ? filteredCustomers : [];

        if (customersToShow.length === 0) {
          const row = document.createElement("tr");
          row.className = "no-orders";
          row.innerHTML = `
            <td colspan="6">
              <div class="empty-state">
                <i class="fas fa-users icon"></i>
                <div class="empty-title">No Customers Found</div>
                <div class="empty-text">Try adjusting your search or filters</div>
              </div>
            </td>
          `;
          tableBody.appendChild(row);
        } else {
          customersToShow.forEach(customer => {
            const row = document.createElement("tr");
            row.innerHTML = `
              <td class="customer-info"><span class="username">${customer.username}</span></td>
              <td>${customer.email}</td>
              <td>${customer.name}</td>
              <td>${customer.joined}</td>
              <td>${customer.orders}</td>
              <td><a href="view-orders.html" class="view-orders"><i class="fa fa-eye"></i> View Orders</a></td>
            `;
            tableBody.appendChild(row);
          });
        }

        document.getElementById("totalCustomers").textContent =
          "Total Customers: " + filteredCustomers.length;

        updatePagination();
      }

      function updatePagination() {
        pageNumbers.innerHTML = "";
        for (let i = 1; i <= 2; i++) {
          const btn = document.createElement("button");
          btn.className = "page-btn" + (i === currentPage ? " active" : "");
          btn.textContent = i;
          btn.addEventListener("click", () => {
            currentPage = i;
            updateTable(currentPage);
          });
          pageNumbers.appendChild(btn);
        }

        prevBtn.disabled = currentPage === 1;
        nextBtn.disabled = currentPage === 2;
      }

      function searchCustomers() {
        const searchTerm = document.getElementById("searchInput").value.toLowerCase();
        filteredCustomers = customers.filter(customer => {
          return (
            (customer.username && customer.username.toLowerCase().includes(searchTerm)) ||
            (customer.email && customer.email.toLowerCase().includes(searchTerm)) ||
            (customer.name && customer.name.toLowerCase().includes(searchTerm))
          );
        });
        currentPage = 1;
        updateTable(currentPage);
      }

      prevBtn.addEventListener("click", () => {
        if (currentPage > 1) {
          currentPage--;
          updateTable(currentPage);
        }
      });

      nextBtn.addEventListener("click", () => {
        if (currentPage < 2) {
          currentPage++;
          updateTable(currentPage);
        }
      });

      window.onload = () => {
        updateTable(currentPage);
      };

     document.addEventListener("DOMContentLoaded", () => {
  // Profile functionality
  const savedUsername = localStorage.getItem("username") || "owner";
  const savedEmail = localStorage.getItem("email") || "owner@signaltone.com";
  const savedProfileImg = localStorage.getItem("profileImg") || "download.jpeg";

  const profileIcon = document.getElementById("profileIcon");
  const profileImg = document.getElementById("profileImg");
  const profileTrigger = document.querySelector(".profile-trigger");
  const profilePopup = document.getElementById("profilePopup");
  const profileForm = document.getElementById("profileForm");
  const usernameInput = document.getElementById("username");
  const emailInput = document.getElementById("email");
  const photoInput = document.getElementById("photoInput");
  const changePhotoBtn = document.getElementById("changePhoto");
  const closeProfilePopupBtn = document.getElementById("closeProfilePopupBtn");
  const profileDropdown = document.getElementById("profileDropdown");
  const editProfileLink = document.getElementById("editProfileLink");
  const settingsLink = document.getElementById("settingsLink");
  const logoutLink = document.getElementById("logoutLink");
  const profileName = document.getElementById("profileName");
  const profileEmail = document.getElementById("profileEmail");

  profileImg.src = savedProfileImg;
  profileIcon.innerHTML = `<img src="${savedProfileImg}" alt="Profile" style="width: 34px; height: 34px; border-radius: 50%;">`;
  profileName.textContent = savedUsername;
  profileEmail.textContent = savedEmail;

  profileTrigger.addEventListener("click", (e) => {
    e.preventDefault();
    profileDropdown.style.display = profileDropdown.style.display === "block" ? "none" : "block";
  });

  editProfileLink.addEventListener("click", (e) => {
    e.preventDefault();
    profileDropdown.style.display = "none";
    profilePopup.style.display = "flex";
  });

  settingsLink.addEventListener("click", (e) => {
    e.preventDefault();
    profileDropdown.style.display = "none";
    profilePopup.style.display = "flex";
  });

  logoutLink.addEventListener("click", (e) => {
    e.preventDefault();
    profileDropdown.style.display = "none";
    if (confirm("Are you sure you want to logout?")) {
      localStorage.removeItem("username");
      localStorage.removeItem("email");
      localStorage.removeItem("profileImg");
      window.location.href = "index.html";
    }
  });

  changePhotoBtn.addEventListener("click", () => {
    photoInput.click();
  });

  photoInput.addEventListener("change", (e) => {
    const file = e.target.files[0];
    if (file) {
      const reader = new FileReader();
      reader.onload = (event) => {
        profileImg.src = event.target.result;
        profileIcon.innerHTML = `<img src="${event.target.result}" alt="Profile" style="width: 34px; height: 34px; border-radius: 50%;">`;
      };
      reader.readAsDataURL(file);
    }
  });

  profileForm.addEventListener("submit", (e) => {
    e.preventDefault();
    const username = usernameInput.value;
    const email = emailInput.value;
    const profileImgSrc = profileImg.src;
    localStorage.setItem("username", username);
    localStorage.setItem("email", email);
    localStorage.setItem("profileImg", profileImgSrc);
    profileIcon.innerHTML = `<img src="${profileImgSrc}" alt="Profile" style="width: 34px; height: 34px; border-radius: 50%;">`;
    profileName.textContent = username;
    profileEmail.textContent = email;
    profilePopup.style.display = "none";
  });

  document.querySelector("#profilePopup .cancel-btn").addEventListener("click", () => {
    profilePopup.style.display = "none";
    usernameInput.value = localStorage.getItem("username") || "owner";
    emailInput.value = localStorage.getItem("email") || "owner@signaltone.com";
    profileImg.src = localStorage.getItem("profileImg") || "download.jpeg";
    profileIcon.innerHTML = `<img src="${profileImg.src}" alt="Profile" style="width: 34px; height: 34px; border-radius: 50%;">`;
    profileName.textContent = usernameInput.value;
    profileEmail.textContent = emailInput.value;
  });

  closeProfilePopupBtn.addEventListener("click", () => {
    profilePopup.style.display = "none";
  });

  // Close dropdown when clicking outside
  document.addEventListener("click", (e) => {
    if (
      !profileTrigger.contains(e.target) &&
      !profileDropdown.contains(e.target)
    ) {
      profileDropdown.style.display = "none";
    }
  });
});


    </script>

    <div class="profile-popup" id="profilePopup" style="display:none;">
  <div class="popup-inner">
    <div class="popup-header">
      <h2>Edit Profile</h2>
      <button class="close-btn" id="closeProfilePopupBtn">&times;</button>
    </div>
    <div class="image-container">
      <img id="profileImg" alt="Profile" style="width: 100px; height: 100px; border-radius: 50%;" />
      <input type="file" id="photoInput" accept="image/*" style="display: none;" />
      <button id="changePhoto" class="image-btn">Change Photo</button>
    </div>
    <form id="profileForm" class="ecommerce-form">
      <div class="form-group">
        <label>Username</label>
        <input type="text" id="username" value="owner" />
      </div>
      <div class="form-group">
        <label>Email</label>
        <input type="email" id="email" value="owner@signaltone.com" />
      </div>
      <div class="form-actions">
        <button type="submit" class="save-btn">Save Changes</button>
        <button type="button" class="cancel-btn">Cancel</button>
      </div>
    </form>
  </div>
</div>
  </body>
</html>